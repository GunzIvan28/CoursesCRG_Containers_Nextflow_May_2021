<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 What is Nextflow? | Courses @ CRG: Reproducible research and data analysis with Linux containers and Nextflow pipelines</title>
  <meta name="description" content="3.1 What is Nextflow? | Courses @ CRG: Reproducible research and data analysis with Linux containers and Nextflow pipelines" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 What is Nextflow? | Courses @ CRG: Reproducible research and data analysis with Linux containers and Nextflow pipelines" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 What is Nextflow? | Courses @ CRG: Reproducible research and data analysis with Linux containers and Nextflow pipelines" />
  
  
  

<meta name="author" content="Sarah Bonnin, Luca Cozzuto, Toni Hermoso, Julia Ponomarenko" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="nextflow.html"/>
<link rel="next" href="first-scripts.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Courses@CRG 2021</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome and about the course</a><ul>
<li class="chapter" data-level="1.1" data-path="meet-the-instructors.html"><a href="meet-the-instructors.html"><i class="fa fa-check"></i><b>1.1</b> Meet the instructors</a></li>
<li class="chapter" data-level="1.2" data-path="about-the-course.html"><a href="about-the-course.html"><i class="fa fa-check"></i><b>1.2</b> About the course</a><ul>
<li class="chapter" data-level="1.2.1" data-path="about-the-course.html"><a href="about-the-course.html#outline"><i class="fa fa-check"></i><b>1.2.1</b> Outline</a></li>
<li class="chapter" data-level="1.2.2" data-path="about-the-course.html"><a href="about-the-course.html#learning-objectives"><i class="fa fa-check"></i><b>1.2.2</b> Learning objectives</a></li>
<li class="chapter" data-level="1.2.3" data-path="about-the-course.html"><a href="about-the-course.html#prerequisite-dates-time-location"><i class="fa fa-check"></i><b>1.2.3</b> Prerequisite, Dates, time, location</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="program.html"><a href="program.html"><i class="fa fa-check"></i><b>1.3</b> Program</a><ul>
<li class="chapter" data-level="1.3.1" data-path="program.html"><a href="program.html#may-3-4-containers"><i class="fa fa-check"></i><b>1.3.1</b> May 3-4: Containers</a></li>
<li class="chapter" data-level="1.3.2" data-path="program.html"><a href="program.html#may-10-11-nextflow"><i class="fa fa-check"></i><b>1.3.2</b> May 10-11: Nextflow</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="containers.html"><a href="containers.html"><i class="fa fa-check"></i><b>2</b> Containers</a></li>
<li class="chapter" data-level="3" data-path="nextflow.html"><a href="nextflow.html"><i class="fa fa-check"></i><b>3</b> Nextflow</a><ul>
<li class="chapter" data-level="3.1" data-path="what-is-nextflow.html"><a href="what-is-nextflow.html"><i class="fa fa-check"></i><b>3.1</b> What is Nextflow?</a><ul>
<li class="chapter" data-level="3.1.1" data-path="what-is-nextflow.html"><a href="what-is-nextflow.html#what-is-nextflow-for"><i class="fa fa-check"></i><b>3.1.1</b> What is Nextflow for?</a></li>
<li class="chapter" data-level="3.1.2" data-path="what-is-nextflow.html"><a href="what-is-nextflow.html#main-advantages"><i class="fa fa-check"></i><b>3.1.2</b> Main advantages</a></li>
<li class="chapter" data-level="3.1.3" data-path="what-is-nextflow.html"><a href="what-is-nextflow.html#workflow-structure"><i class="fa fa-check"></i><b>3.1.3</b> Workflow structure</a></li>
<li class="chapter" data-level="3.1.4" data-path="what-is-nextflow.html"><a href="what-is-nextflow.html#installation"><i class="fa fa-check"></i><b>3.1.4</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="first-scripts.html"><a href="first-scripts.html"><i class="fa fa-check"></i><b>3.2</b> First scripts</a><ul>
<li class="chapter" data-level="3.2.1" data-path="first-scripts.html"><a href="first-scripts.html#channels"><i class="fa fa-check"></i><b>3.2.1</b> Channels</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i><b>3.3</b> EXERCISE 1</a></li>
<li class="chapter" data-level="3.4" data-path="processes.html"><a href="processes.html"><i class="fa fa-check"></i><b>3.4</b> Processes</a><ul>
<li class="chapter" data-level="3.4.1" data-path="processes.html"><a href="processes.html#workflow"><i class="fa fa-check"></i><b>3.4.1</b> Workflow</a></li>
<li class="chapter" data-level="3.4.2" data-path="processes.html"><a href="processes.html#nextflow-log"><i class="fa fa-check"></i><b>3.4.2</b> Nextflow log</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i><b>3.5</b> EXERCISE 2</a></li>
<li class="chapter" data-level="3.6" data-path="more-complex-scripts.html"><a href="more-complex-scripts.html"><i class="fa fa-check"></i><b>3.6</b> More complex scripts</a></li>
<li class="chapter" data-level="3.7" data-path="exercise-3.html"><a href="exercise-3.html"><i class="fa fa-check"></i><b>3.7</b> EXERCISE 3</a></li>
<li class="chapter" data-level="3.8" data-path="resuming-your-pipeline.html"><a href="resuming-your-pipeline.html"><i class="fa fa-check"></i><b>3.8</b> Resuming your pipeline</a></li>
<li class="chapter" data-level="3.9" data-path="decoupling-resources-parameters-and-nextflow-script.html"><a href="decoupling-resources-parameters-and-nextflow-script.html"><i class="fa fa-check"></i><b>3.9</b> Decoupling resources, parameters and nextflow script</a><ul>
<li class="chapter" data-level="3.9.1" data-path="decoupling-resources-parameters-and-nextflow-script.html"><a href="decoupling-resources-parameters-and-nextflow-script.html#publishing-final-results"><i class="fa fa-check"></i><b>3.9.1</b> Publishing final results</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="adding-a-help-section-for-the-whole-pipeline.html"><a href="adding-a-help-section-for-the-whole-pipeline.html"><i class="fa fa-check"></i><b>3.10</b> Adding a help section for the whole pipeline</a></li>
<li class="chapter" data-level="3.11" data-path="using-singularity.html"><a href="using-singularity.html"><i class="fa fa-check"></i><b>3.11</b> Using Singularity</a></li>
<li class="chapter" data-level="3.12" data-path="adding-more-steps.html"><a href="adding-more-steps.html"><i class="fa fa-check"></i><b>3.12</b> Adding more steps</a></li>
<li class="chapter" data-level="3.13" data-path="modules-and-re-usage-of-the-code.html"><a href="modules-and-re-usage-of-the-code.html"><i class="fa fa-check"></i><b>3.13</b> Modules and re-usage of the code</a></li>
<li class="chapter" data-level="3.14" data-path="exercise-4.html"><a href="exercise-4.html"><i class="fa fa-check"></i><b>3.14</b> EXERCISE 4</a></li>
<li class="chapter" data-level="3.15" data-path="reporting-and-graphical-interface.html"><a href="reporting-and-graphical-interface.html"><i class="fa fa-check"></i><b>3.15</b> Reporting and graphical interface</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://biocore.crg.eu/wiki/Main_Page" target="blank">BIOINFORMATICS CORE @ CRG</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Courses @ CRG: Reproducible research and data analysis with Linux containers and Nextflow pipelines</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="what-is-nextflow" class="section level2">
<h2><span class="header-section-number">3.1</span> What is Nextflow?</h2>
<p><a href="https://www.nextflow.io" target="_blank"><img src="docs/images/nextf_groovy.png" width="600px" /></a></p>
<p><a href="https://www.nextflow.io">Nextflow</a> is a domain specific language for workflow orchestration that stems from <a href="https://groovy-lang.org/">Groovy</a>. It enables scalable and reproducible workflows using software containers. It was developed at <a href="www.crg.eu">CRG</a> in the Lab of Cedric Notredame by Paolo Di Tommaso <a href="https://github.com/pditommaso">https://github.com/pditommaso</a>. The Nextflow documentantion is <a href="https://www.nextflow.io/docs/latest/">available here</a> and you can ask help to the community using their <a href="https://gitter.im/nextflow-io/nextflow">gitter channel</a></p>
<p>Nextflow has been currently upgrade from DLS1 version to DLS2. In this course we will use exclusively DLS2.</p>
<div id="what-is-nextflow-for" class="section level3">
<h3><span class="header-section-number">3.1.1</span> What is Nextflow for?</h3>
<p>It is for making pipelines without caring about parallelization, dependencies, intermediate file names, data structures, handling exceptions, resuming executions etc. It was published in <a href="https://pubmed.ncbi.nlm.nih.gov/28398311/">Nature Biotechnology in 2017</a>.</p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/28398311/" target="_blank"><img src="docs/images/NF_pub.png" width="600px" /></a></p>
<p>There is a growing number of publication mentioning Nextflow in PubMed, since many bioinformaticians are starting to write their pipeline in Nextflow.</p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/?term=nextflow&timeline=expanded&sort=pubdate&sort_order=asc" target="_blank"><img src="docs/images/NF_mentioning.png" width="600px" /></a></p>
<p>Here a curated list of <a href="https://github.com/nextflow-io/awesome-nextflow">Nextflow pipelines</a></p>
<p>And here a group of pipelines written in a collaborative way from project <a href="https://nf-co.re/pipelines">NF-core</a></p>
<p>Some pipelines written in Nextflow are being used for SARS-Cov-2 analysis like:</p>
<ul>
<li>the one from the <a href="https://artic.network/ncov-2019">artic Network</a>: <a href="https://github.com/connor-lab/ncov2019-artic-nf">ncov2019-artic-nf</a></li>
<li>the one used from the <a href="https://covid19beacon.crg.eu/info">CRG / EGA viral Beacon</a>, <a href="https://github.com/biocorecrg/master_of_pores">Master of Pores</a></li>
<li>the nf-core pipeline <a href="https://nf-co.re/viralrecon">viralrecon</a></li>
</ul>
<p>etc.</p>
</div>
<div id="main-advantages" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Main advantages</h3>
<ul>
<li>Fast prototyping</li>
</ul>
<p>You can quickly write a small pipeline that can be expanded incrementally. Each task is independent and can be easily added to other ones.
You can reuse your scripts and tools without rewriting / adapting them.
- Reproducibility</p>
<p>Nextflow supports Docker and Singularity containers technology. Their use will make the pipelines reproducible in any unix environment. Nextflow is integrated with GitHub code sharing platform so you can call directly a specific version of pipeline from a repository, download it and use it on the fly.</p>
<ul>
<li>Portable</li>
</ul>
<p>Nextflow can be executed on multiple platforms without modifiying the code. It supports several schedulers such as SGE, LSF, SLURM, PBS and HTCondor and cloud platforms like Kubernetes, Amazon AWS and Google Cloud.</p>
<p><img src="docs/images/executors.png" width="600px" /></p>
<ul>
<li>Scalability</li>
</ul>
<p>Nextflow is based on the dataflow programming model which simplifies writing complex pipelines. The tool takes care of parallelizing the processes without additional written code. The resulting applications are inherently parallel and can scale-up or scale-out, transparently, without having to adapt to a specific platform architecture.</p>
<ul>
<li>Resumable, thanks to continuous checkpoints</li>
</ul>
<p>All the intermediate results produced during the pipeline execution are automatically tracked. For each process a temporary folder is created and is cached (or not) once resuming an execution.</p>
</div>
<div id="workflow-structure" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Workflow structure</h3>
<p>The workflows can be repesented as graphs where the nodes are the <strong>processes</strong> and the edges are the <strong>channels</strong>.
The <strong>processes</strong> are block of code that can be executed such as scripts or programs, while the <strong>channels</strong> are asynchronous queue able to connect processess among them via input / output.</p>
<p><img src="docs/images/wf_example.png" width="800px" /></p>
<p>Each process is independent from the other and can be run in parallel depending on the number of elements in a channel. In the previous example the processes A, B and C can be run in parallel and only at their end the process D is triggered.</p>
</div>
<div id="installation" class="section level3">
<h3><span class="header-section-number">3.1.4</span> Installation</h3>
<p>We need at least Java version 8.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="what-is-nextflow.html#cb4-1"></a><span class="ex">java</span> -version</span></code></pre></div>
<p>Then we can install it by typing:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="what-is-nextflow.html#cb5-1"></a><span class="ex">curl</span> -s https://get.nextflow.io <span class="kw">|</span> <span class="fu">bash</span></span></code></pre></div>
<p>This will create an executable called nextflow that can be moved to /usr/local/bin or where we prefer. We can finally test using:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="what-is-nextflow.html#cb6-1"></a><span class="ex">./nextflow</span> run hello</span>
<span id="cb6-2"><a href="what-is-nextflow.html#cb6-2"></a></span>
<span id="cb6-3"><a href="what-is-nextflow.html#cb6-3"></a><span class="ex">N</span> E X T F L O W  ~  version 20.07.1</span>
<span id="cb6-4"><a href="what-is-nextflow.html#cb6-4"></a><span class="ex">Pulling</span> nextflow-io/hello ...</span>
<span id="cb6-5"><a href="what-is-nextflow.html#cb6-5"></a><span class="ex">downloaded</span> from https://github.com/nextflow-io/hello.git</span>
<span id="cb6-6"><a href="what-is-nextflow.html#cb6-6"></a><span class="ex">Launching</span> <span class="kw">`</span><span class="ex">nextflow-io/hello</span><span class="kw">`</span> [peaceful_brahmagupta] - revision: 96eb04d6a4 [master]</span>
<span id="cb6-7"><a href="what-is-nextflow.html#cb6-7"></a><span class="ex">executor</span> <span class="op">&gt;</span>  local (4)</span>
<span id="cb6-8"><a href="what-is-nextflow.html#cb6-8"></a>[<span class="ex">d7</span>/<span class="ex">d053b5</span>] process <span class="op">&gt;</span> sayHello (4) [<span class="ex">100%</span>] 4 of 4 ✔</span>
<span id="cb6-9"><a href="what-is-nextflow.html#cb6-9"></a><span class="ex">Ciao</span> world!</span>
<span id="cb6-10"><a href="what-is-nextflow.html#cb6-10"></a></span>
<span id="cb6-11"><a href="what-is-nextflow.html#cb6-11"></a><span class="ex">Bonjour</span> world!</span>
<span id="cb6-12"><a href="what-is-nextflow.html#cb6-12"></a></span>
<span id="cb6-13"><a href="what-is-nextflow.html#cb6-13"></a><span class="ex">Hello</span> world!</span>
<span id="cb6-14"><a href="what-is-nextflow.html#cb6-14"></a></span>
<span id="cb6-15"><a href="what-is-nextflow.html#cb6-15"></a><span class="ex">Hola</span> world!</span></code></pre></div>
<p>This command download from the a github repository and it runs the test script hello.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="nextflow.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="first-scripts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["courses_at_crg_2021.pdf", "courses_at_crg_2021.epub"],
"toc": {
"collapse": "section"
},
"search": true
});
});
</script>

</body>

</html>
