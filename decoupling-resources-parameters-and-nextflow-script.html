<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.1 Decoupling resources, parameters and nextflow script | Courses @ CRG: Reproducible research and data analysis with Linux containers and Nextflow pipelines</title>
  <meta name="description" content="6.1 Decoupling resources, parameters and nextflow script | Courses @ CRG: Reproducible research and data analysis with Linux containers and Nextflow pipelines" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="6.1 Decoupling resources, parameters and nextflow script | Courses @ CRG: Reproducible research and data analysis with Linux containers and Nextflow pipelines" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.1 Decoupling resources, parameters and nextflow script | Courses @ CRG: Reproducible research and data analysis with Linux containers and Nextflow pipelines" />
  
  
  

<meta name="author" content="Sarah Bonnin, Luca Cozzuto, Toni Hermoso, Julia Ponomarenko" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="nextflow-day-2.html"/>
<link rel="next" href="adding-a-help-section-for-the-whole-pipeline.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Courses@CRG 2021</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome and about the course</a><ul>
<li class="chapter" data-level="1.1" data-path="meet-the-organizers-and-instructors.html"><a href="meet-the-organizers-and-instructors.html"><i class="fa fa-check"></i><b>1.1</b> Meet the organizers and instructors</a></li>
<li class="chapter" data-level="1.2" data-path="about-the-course.html"><a href="about-the-course.html"><i class="fa fa-check"></i><b>1.2</b> About the course</a><ul>
<li class="chapter" data-level="1.2.1" data-path="about-the-course.html"><a href="about-the-course.html#outline"><i class="fa fa-check"></i><b>1.2.1</b> Outline</a></li>
<li class="chapter" data-level="1.2.2" data-path="about-the-course.html"><a href="about-the-course.html#learning-objectives"><i class="fa fa-check"></i><b>1.2.2</b> Learning objectives</a></li>
<li class="chapter" data-level="1.2.3" data-path="about-the-course.html"><a href="about-the-course.html#prerequisite-technical-requirements"><i class="fa fa-check"></i><b>1.2.3</b> Prerequisite / technical requirements</a></li>
<li class="chapter" data-level="1.2.4" data-path="about-the-course.html"><a href="about-the-course.html#dates-time-location"><i class="fa fa-check"></i><b>1.2.4</b> Dates, time, location</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="program.html"><a href="program.html"><i class="fa fa-check"></i><b>1.3</b> Program</a><ul>
<li class="chapter" data-level="1.3.1" data-path="program.html"><a href="program.html#may-3-4-containers"><i class="fa fa-check"></i><b>1.3.1</b> May 3-4: Containers</a></li>
<li class="chapter" data-level="1.3.2" data-path="program.html"><a href="program.html#may-10-11-nextflow"><i class="fa fa-check"></i><b>1.3.2</b> May 10-11: Nextflow</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-containers.html"><a href="introduction-to-containers.html"><i class="fa fa-check"></i><b>2</b> Introduction to containers</a><ul>
<li class="chapter" data-level="2.1" data-path="what-are-containers.html"><a href="what-are-containers.html"><i class="fa fa-check"></i><b>2.1</b> What are containers ?</a></li>
<li class="chapter" data-level="2.2" data-path="virtual-machines-or-containers.html"><a href="virtual-machines-or-containers.html"><i class="fa fa-check"></i><b>2.2</b> Virtual machines or containers ?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="virtual-machines-or-containers.html"><a href="virtual-machines-or-containers.html#virtualisation"><i class="fa fa-check"></i><b>2.2.1</b> Virtualisation</a></li>
<li class="chapter" data-level="2.2.2" data-path="virtual-machines-or-containers.html"><a href="virtual-machines-or-containers.html#containerisation-aka-lightweight-virtualisation"><i class="fa fa-check"></i><b>2.2.2</b> Containerisation (aka lightweight virtualisation)</a></li>
<li class="chapter" data-level="2.2.3" data-path="virtual-machines-or-containers.html"><a href="virtual-machines-or-containers.html#virtual-machines-vs-containers"><i class="fa fa-check"></i><b>2.2.3</b> Virtual machines vs containers</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="history-of-containers.html"><a href="history-of-containers.html"><i class="fa fa-check"></i><b>2.3</b> History of containers</a><ul>
<li class="chapter" data-level="2.3.1" data-path="history-of-containers.html"><a href="history-of-containers.html#chroot"><i class="fa fa-check"></i><b>2.3.1</b> chroot</a></li>
<li class="chapter" data-level="2.3.2" data-path="history-of-containers.html"><a href="history-of-containers.html#additions-in-linux-kernel"><i class="fa fa-check"></i><b>2.3.2</b> Additions in Linux kernel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="docker.html"><a href="docker.html"><i class="fa fa-check"></i><b>3</b> Docker</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-docker.html"><a href="introduction-to-docker.html"><i class="fa fa-check"></i><b>3.1</b> Introduction to Docker</a><ul>
<li class="chapter" data-level="3.1.1" data-path="introduction-to-docker.html"><a href="introduction-to-docker.html#what-is-docker"><i class="fa fa-check"></i><b>3.1.1</b> What is Docker?</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduction-to-docker.html"><a href="introduction-to-docker.html#docker-components"><i class="fa fa-check"></i><b>3.1.2</b> Docker components</a></li>
<li class="chapter" data-level="3.1.3" data-path="introduction-to-docker.html"><a href="introduction-to-docker.html#images-versus-containers"><i class="fa fa-check"></i><b>3.1.3</b> Images versus containers</a></li>
<li class="chapter" data-level="3.1.4" data-path="introduction-to-docker.html"><a href="introduction-to-docker.html#docker-vocabulary"><i class="fa fa-check"></i><b>3.1.4</b> Docker vocabulary</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="using-existing-images.html"><a href="using-existing-images.html"><i class="fa fa-check"></i><b>3.2</b> Using existing images</a><ul>
<li class="chapter" data-level="3.2.1" data-path="using-existing-images.html"><a href="using-existing-images.html#getting-started"><i class="fa fa-check"></i><b>3.2.1</b> Getting started</a></li>
<li class="chapter" data-level="3.2.2" data-path="using-existing-images.html"><a href="using-existing-images.html#explore-docker-hub"><i class="fa fa-check"></i><b>3.2.2</b> Explore Docker Hub</a></li>
<li class="chapter" data-level="3.2.3" data-path="using-existing-images.html"><a href="using-existing-images.html#docker-pull-import-an-image"><i class="fa fa-check"></i><b>3.2.3</b> docker pull: import an image</a></li>
<li class="chapter" data-level="3.2.4" data-path="using-existing-images.html"><a href="using-existing-images.html#docker-run-run-image-i.e.-start-a-container"><i class="fa fa-check"></i><b>3.2.4</b> docker run: run image, i.e. start a container</a></li>
<li class="chapter" data-level="3.2.5" data-path="using-existing-images.html"><a href="using-existing-images.html#docker-ps-check-containers-status"><i class="fa fa-check"></i><b>3.2.5</b> docker ps: check containers status</a></li>
<li class="chapter" data-level="3.2.6" data-path="using-existing-images.html"><a href="using-existing-images.html#docker-exec-execute-process-in-a-running-container"><i class="fa fa-check"></i><b>3.2.6</b> docker exec: execute process in a running container</a></li>
<li class="chapter" data-level="3.2.7" data-path="using-existing-images.html"><a href="using-existing-images.html#docker-stop-start-restart-actions-on-container"><i class="fa fa-check"></i><b>3.2.7</b> docker stop, start, restart: actions on container</a></li>
<li class="chapter" data-level="3.2.8" data-path="using-existing-images.html"><a href="using-existing-images.html#docker-rm-docker-rmi-clean-up"><i class="fa fa-check"></i><b>3.2.8</b> docker rm, docker rmi: clean up!</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="exercise-1-docker-as-a-user.html"><a href="exercise-1-docker-as-a-user.html"><i class="fa fa-check"></i><b>3.3</b> Exercise 1 - Docker as a user</a></li>
<li class="chapter" data-level="3.4" data-path="linux-packages.html"><a href="linux-packages.html"><i class="fa fa-check"></i><b>3.4</b> Linux packages</a><ul>
<li class="chapter" data-level="3.4.1" data-path="linux-packages.html"><a href="linux-packages.html#update-and-upgrade-packages"><i class="fa fa-check"></i><b>3.4.1</b> Update and upgrade packages</a></li>
<li class="chapter" data-level="3.4.2" data-path="linux-packages.html"><a href="linux-packages.html#search-and-install-packages"><i class="fa fa-check"></i><b>3.4.2</b> Search and install packages:</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="docker-recipes.html"><a href="docker-recipes.html"><i class="fa fa-check"></i><b>3.5</b> Docker recipes</a><ul>
<li class="chapter" data-level="3.5.1" data-path="docker-recipes.html"><a href="docker-recipes.html#writing-recipes-and-building-images"><i class="fa fa-check"></i><b>3.5.1</b> Writing recipes and building images</a></li>
<li class="chapter" data-level="3.5.2" data-path="docker-recipes.html"><a href="docker-recipes.html#docker-tag"><i class="fa fa-check"></i><b>3.5.2</b> docker tag</a></li>
<li class="chapter" data-level="3.5.3" data-path="docker-recipes.html"><a href="docker-recipes.html#build-cache"><i class="fa fa-check"></i><b>3.5.3</b> Build cache</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="exercise-2-docker-recipes-and-build-images.html"><a href="exercise-2-docker-recipes-and-build-images.html"><i class="fa fa-check"></i><b>3.6</b> Exercise 2 - Docker recipes and build images</a><ul>
<li class="chapter" data-level="3.6.1" data-path="exercise-2-docker-recipes-and-build-images.html"><a href="exercise-2-docker-recipes-and-build-images.html#additional-commands"><i class="fa fa-check"></i><b>3.6.1</b> Additional commands</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="volumes.html"><a href="volumes.html"><i class="fa fa-check"></i><b>3.7</b> Volumes</a></li>
<li class="chapter" data-level="3.8" data-path="ports.html"><a href="ports.html"><i class="fa fa-check"></i><b>3.8</b> Ports</a></li>
<li class="chapter" data-level="3.9" data-path="integrative-examples.html"><a href="integrative-examples.html"><i class="fa fa-check"></i><b>3.9</b> Integrative examples</a><ul>
<li class="chapter" data-level="3.9.1" data-path="integrative-examples.html"><a href="integrative-examples.html#fastqc-web-application"><i class="fa fa-check"></i><b>3.9.1</b> FASTQC Web Application</a></li>
<li class="chapter" data-level="3.9.2" data-path="integrative-examples.html"><a href="integrative-examples.html#shiny-application"><i class="fa fa-check"></i><b>3.9.2</b> Shiny Application</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="publish-images.html"><a href="publish-images.html"><i class="fa fa-check"></i><b>3.10</b> Publish images</a><ul>
<li class="chapter" data-level="3.10.1" data-path="publish-images.html"><a href="publish-images.html#push-an-image"><i class="fa fa-check"></i><b>3.10.1</b> Push an image</a></li>
<li class="chapter" data-level="3.10.2" data-path="publish-images.html"><a href="publish-images.html#automatic-builds"><i class="fa fa-check"></i><b>3.10.2</b> Automatic builds</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="exercise-3-docker-volumes-and-ports.html"><a href="exercise-3-docker-volumes-and-ports.html"><i class="fa fa-check"></i><b>3.11</b> Exercise 3 - Docker volumes and ports</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="singularity.html"><a href="singularity.html"><i class="fa fa-check"></i><b>4</b> Singularity</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-singularity.html"><a href="introduction-to-singularity.html"><i class="fa fa-check"></i><b>4.1</b> Introduction to Singularity</a><ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-to-singularity.html"><a href="introduction-to-singularity.html#singularity-architecture"><i class="fa fa-check"></i><b>4.1.1</b> Singularity architecture</a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-to-singularity.html"><a href="introduction-to-singularity.html#strengths"><i class="fa fa-check"></i><b>4.1.2</b> Strengths</a></li>
<li class="chapter" data-level="4.1.3" data-path="introduction-to-singularity.html"><a href="introduction-to-singularity.html#weaknesses"><i class="fa fa-check"></i><b>4.1.3</b> Weaknesses</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="build-process.html"><a href="build-process.html"><i class="fa fa-check"></i><b>4.2</b> Build process</a><ul>
<li class="chapter" data-level="4.2.1" data-path="build-process.html"><a href="build-process.html#examples"><i class="fa fa-check"></i><b>4.2.1</b> Examples</a></li>
<li class="chapter" data-level="4.2.2" data-path="build-process.html"><a href="build-process.html#sandboxing"><i class="fa fa-check"></i><b>4.2.2</b> Sandboxing</a></li>
<li class="chapter" data-level="4.2.3" data-path="build-process.html"><a href="build-process.html#singularity-recipes"><i class="fa fa-check"></i><b>4.2.3</b> Singularity recipes</a></li>
<li class="chapter" data-level="4.2.4" data-path="build-process.html"><a href="build-process.html#remote-building"><i class="fa fa-check"></i><b>4.2.4</b> Remote building</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="run-and-execution-process.html"><a href="run-and-execution-process.html"><i class="fa fa-check"></i><b>4.3</b> Run and execution process</a><ul>
<li class="chapter" data-level="4.3.1" data-path="run-and-execution-process.html"><a href="run-and-execution-process.html#singularity-shell"><i class="fa fa-check"></i><b>4.3.1</b> Singularity shell</a></li>
<li class="chapter" data-level="4.3.2" data-path="run-and-execution-process.html"><a href="run-and-execution-process.html#singularity-exec"><i class="fa fa-check"></i><b>4.3.2</b> Singularity exec</a></li>
<li class="chapter" data-level="4.3.3" data-path="run-and-execution-process.html"><a href="run-and-execution-process.html#singularity-run"><i class="fa fa-check"></i><b>4.3.3</b> Singularity run</a></li>
<li class="chapter" data-level="4.3.4" data-path="run-and-execution-process.html"><a href="run-and-execution-process.html#environment-control"><i class="fa fa-check"></i><b>4.3.4</b> Environment control</a></li>
<li class="chapter" data-level="4.3.5" data-path="run-and-execution-process.html"><a href="run-and-execution-process.html#execute-from-sandboxed-images-directories"><i class="fa fa-check"></i><b>4.3.5</b> Execute from sandboxed images / directories</a></li>
<li class="chapter" data-level="4.3.6" data-path="run-and-execution-process.html"><a href="run-and-execution-process.html#execute-straight-from-a-registry"><i class="fa fa-check"></i><b>4.3.6</b> Execute straight from a registry</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="bind-paths-aka-volumes.html"><a href="bind-paths-aka-volumes.html"><i class="fa fa-check"></i><b>4.4</b> Bind paths (aka volumes)</a></li>
<li class="chapter" data-level="4.5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>4.5</b> Exercises:</a></li>
<li class="chapter" data-level="4.6" data-path="instances.html"><a href="instances.html"><i class="fa fa-check"></i><b>4.6</b> Instances</a></li>
<li class="chapter" data-level="4.7" data-path="troubleshooting.html"><a href="troubleshooting.html"><i class="fa fa-check"></i><b>4.7</b> Troubleshooting</a><ul>
<li class="chapter" data-level="4.7.1" data-path="troubleshooting.html"><a href="troubleshooting.html#fakeroot"><i class="fa fa-check"></i><b>4.7.1</b> Fakeroot</a></li>
<li class="chapter" data-level="4.7.2" data-path="troubleshooting.html"><a href="troubleshooting.html#singularity-cache-directory"><i class="fa fa-check"></i><b>4.7.2</b> Singularity cache directory</a></li>
<li class="chapter" data-level="4.7.3" data-path="troubleshooting.html"><a href="troubleshooting.html#global-singularity-configuration"><i class="fa fa-check"></i><b>4.7.3</b> Global singularity configuration</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="exercise-4-singularity-running-and-building.html"><a href="exercise-4-singularity-running-and-building.html"><i class="fa fa-check"></i><b>4.8</b> Exercise 4 - Singularity running and building</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="nextflow-day-1.html"><a href="nextflow-day-1.html"><i class="fa fa-check"></i><b>5</b> Nextflow day 1</a><ul>
<li class="chapter" data-level="5.1" data-path="what-is-nextflow.html"><a href="what-is-nextflow.html"><i class="fa fa-check"></i><b>5.1</b> What is Nextflow?</a></li>
<li class="chapter" data-level="5.2" data-path="what-is-nextflow-for.html"><a href="what-is-nextflow-for.html"><i class="fa fa-check"></i><b>5.2</b> What is Nextflow for?</a></li>
<li class="chapter" data-level="5.3" data-path="main-advantages.html"><a href="main-advantages.html"><i class="fa fa-check"></i><b>5.3</b> Main advantages</a></li>
<li class="chapter" data-level="5.4" data-path="workflow-structure.html"><a href="workflow-structure.html"><i class="fa fa-check"></i><b>5.4</b> Workflow structure</a></li>
<li class="chapter" data-level="5.5" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>5.5</b> Installation</a></li>
<li class="chapter" data-level="5.6" data-path="channels-and-operators.html"><a href="channels-and-operators.html"><i class="fa fa-check"></i><b>5.6</b> Channels and Operators</a></li>
<li class="chapter" data-level="5.7" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i><b>5.7</b> EXERCISE 1</a></li>
<li class="chapter" data-level="5.8" data-path="processes.html"><a href="processes.html"><i class="fa fa-check"></i><b>5.8</b> Processes</a></li>
<li class="chapter" data-level="5.9" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>5.9</b> Workflow</a></li>
<li class="chapter" data-level="5.10" data-path="nextflow-log.html"><a href="nextflow-log.html"><i class="fa fa-check"></i><b>5.10</b> Nextflow log</a></li>
<li class="chapter" data-level="5.11" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i><b>5.11</b> EXERCISE 2</a></li>
<li class="chapter" data-level="5.12" data-path="more-complex-scripts.html"><a href="more-complex-scripts.html"><i class="fa fa-check"></i><b>5.12</b> More complex scripts</a></li>
<li class="chapter" data-level="5.13" data-path="directives.html"><a href="directives.html"><i class="fa fa-check"></i><b>5.13</b> Directives</a></li>
<li class="chapter" data-level="5.14" data-path="resuming-your-pipeline.html"><a href="resuming-your-pipeline.html"><i class="fa fa-check"></i><b>5.14</b> Resuming your pipeline</a></li>
<li class="chapter" data-level="5.15" data-path="exercise-3.html"><a href="exercise-3.html"><i class="fa fa-check"></i><b>5.15</b> EXERCISE 3</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nextflow-day-2.html"><a href="nextflow-day-2.html"><i class="fa fa-check"></i><b>6</b> Nextflow day 2</a><ul>
<li class="chapter" data-level="6.1" data-path="decoupling-resources-parameters-and-nextflow-script.html"><a href="decoupling-resources-parameters-and-nextflow-script.html"><i class="fa fa-check"></i><b>6.1</b> Decoupling resources, parameters and nextflow script</a><ul>
<li class="chapter" data-level="6.1.1" data-path="decoupling-resources-parameters-and-nextflow-script.html"><a href="decoupling-resources-parameters-and-nextflow-script.html#publishing-final-results"><i class="fa fa-check"></i><b>6.1.1</b> Publishing final results</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="adding-a-help-section-for-the-whole-pipeline.html"><a href="adding-a-help-section-for-the-whole-pipeline.html"><i class="fa fa-check"></i><b>6.2</b> Adding a help section for the whole pipeline</a></li>
<li class="chapter" data-level="6.3" data-path="exercise-4.html"><a href="exercise-4.html"><i class="fa fa-check"></i><b>6.3</b> EXERCISE 4</a></li>
<li class="chapter" data-level="6.4" data-path="using-singularity.html"><a href="using-singularity.html"><i class="fa fa-check"></i><b>6.4</b> Using Singularity</a></li>
<li class="chapter" data-level="6.5" data-path="adding-more-steps.html"><a href="adding-more-steps.html"><i class="fa fa-check"></i><b>6.5</b> Adding more steps</a></li>
<li class="chapter" data-level="6.6" data-path="profiles.html"><a href="profiles.html"><i class="fa fa-check"></i><b>6.6</b> Profiles</a></li>
<li class="chapter" data-level="6.7" data-path="deployment-in-the-aws-cloud.html"><a href="deployment-in-the-aws-cloud.html"><i class="fa fa-check"></i><b>6.7</b> Deployment in the AWS cloud</a></li>
<li class="chapter" data-level="6.8" data-path="exercise-5.html"><a href="exercise-5.html"><i class="fa fa-check"></i><b>6.8</b> EXERCISE 5</a></li>
<li class="chapter" data-level="6.9" data-path="modules-and-re-usage-of-the-code.html"><a href="modules-and-re-usage-of-the-code.html"><i class="fa fa-check"></i><b>6.9</b> Modules and re-usage of the code</a></li>
<li class="chapter" data-level="6.10" data-path="exercise-6.html"><a href="exercise-6.html"><i class="fa fa-check"></i><b>6.10</b> EXERCISE 6</a></li>
<li class="chapter" data-level="6.11" data-path="reporting-and-graphical-interface.html"><a href="reporting-and-graphical-interface.html"><i class="fa fa-check"></i><b>6.11</b> Reporting and graphical interface</a></li>
<li class="chapter" data-level="6.12" data-path="share-nextflow-pipelines-and-good-practices.html"><a href="share-nextflow-pipelines-and-good-practices.html"><i class="fa fa-check"></i><b>6.12</b> Share Nextflow pipelines and good practices</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://biocore.crg.eu/wiki/Main_Page" target="blank">BIOINFORMATICS CORE @ CRG</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Courses @ CRG: Reproducible research and data analysis with Linux containers and Nextflow pipelines</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="decoupling-resources-parameters-and-nextflow-script" class="section level2">
<h2><span class="header-section-number">6.1</span> Decoupling resources, parameters and nextflow script</h2>
<p>When you make a complex pipelines you might want to keep separated the definition of resources needed, the default parameters and the main script.
You can achieve this by two additional files:</p>
<ul>
<li>nextflow.config</li>
<li>params.config</li>
</ul>
<p>The <strong>nextflow.config</strong> file allows to indicate the resources needed for each class of processes.
You can label your processes to make a link with the definitions in the nextflow.config file. This is an example of a nextflow.config file:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb165-1"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-1"></a><span class="ex">includeConfig</span> <span class="st">&quot;</span><span class="va">$baseDir</span><span class="st">/params.config&quot;</span></span>
<span id="cb165-2"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-2"></a></span>
<span id="cb165-3"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-3"></a><span class="ex">process</span> {</span>
<span id="cb165-4"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-4"></a>     <span class="va">memory=</span><span class="st">&#39;0.6G&#39;</span></span>
<span id="cb165-5"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-5"></a>     <span class="va">cpus=</span><span class="st">&#39;1&#39;</span></span>
<span id="cb165-6"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-6"></a>     <span class="va">time=</span><span class="st">&#39;6h&#39;</span></span>
<span id="cb165-7"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-7"></a></span>
<span id="cb165-8"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-8"></a>     <span class="ex">withLabel</span>: <span class="st">&#39;onecpu&#39;</span></span>
<span id="cb165-9"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-9"></a>    <span class="kw">{</span></span>
<span id="cb165-10"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-10"></a>        <span class="va">memory=</span><span class="st">&#39;0.6G&#39;</span></span>
<span id="cb165-11"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-11"></a>        <span class="va">cpus=</span><span class="st">&#39;1&#39;</span></span>
<span id="cb165-12"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-12"></a>    <span class="kw">}</span>   </span>
<span id="cb165-13"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-13"></a></span>
<span id="cb165-14"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-14"></a>}</span>
<span id="cb165-15"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-15"></a></span>
<span id="cb165-16"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-16"></a><span class="ex">process.container</span> = <span class="st">&#39;biocorecrg/c4lwg-2018:latest&#39;</span></span>
<span id="cb165-17"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb165-17"></a><span class="ex">singularity.cacheDir</span> = <span class="st">&quot;</span><span class="va">$baseDir</span><span class="st">/singularity&quot;</span></span></code></pre></div>
<p>The first row indicates to use the information stored in the <strong>params.config</strong> file (described later). Then we have the definition of the default resources for a process:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb166-1"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb166-1"></a><span class="ex">process</span> {</span>
<span id="cb166-2"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb166-2"></a>     <span class="va">memory=</span><span class="st">&#39;0.6G&#39;</span></span>
<span id="cb166-3"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb166-3"></a>     <span class="va">cpus=</span><span class="st">&#39;1&#39;</span></span>
<span id="cb166-4"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb166-4"></a>     <span class="va">time=</span><span class="st">&#39;6h&#39;</span></span>
<span id="cb166-5"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb166-5"></a><span class="ex">...</span></span></code></pre></div>
<p>Then we have the resources needed for a class of processes in particular labeled with <strong>bigmem</strong></p>
<pre><code>     withLabel: &#39;bigmem&#39;
    {
        memory=&#39;0.7G&#39;
        cpus=&#39;1&#39;
    }   </code></pre>
<p>If we have a look at the process <strong>fastQC</strong> within the test2.nf file, we can see the use of the label.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb168-1"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb168-1"></a><span class="co">/*</span></span>
<span id="cb168-2"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb168-2"></a><span class="co"> * Process 1. Run FastQC on raw data.</span></span>
<span id="cb168-3"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb168-3"></a><span class="co"> */</span></span>
<span id="cb168-4"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb168-4"></a>process fastQC {</span>
<span id="cb168-5"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb168-5"></a>    publishDir fastqcOutputFolder       </span>
<span id="cb168-6"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb168-6"></a>    tag { reads }                   </span>
<span id="cb168-7"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb168-7"></a>    label &#39;bigmem&#39;</span>
<span id="cb168-8"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb168-8"></a></span>
<span id="cb168-9"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb168-9"></a>    input:</span>
<span id="cb168-10"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb168-10"></a>    path reads                              </span>
<span id="cb168-11"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb168-11"></a>...</span></code></pre></div>
<p>The latest two rows of the config file indicates which container needs to be used. In this case, it assumes has to be pulled from <a href="https://hub.docker.com/">DockerHub</a>. In case you want to use singularity you can indicate where to store the local image by using the <strong>singularity.cacheDir</strong> setting</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb169-1"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb169-1"></a>process.<span class="fu">container</span> = &#39;biocorecrg/c4lwg-<span class="dv">2018</span>:latest&#39;</span>
<span id="cb169-2"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb169-2"></a>singularity.<span class="fu">cacheDir</span> = <span class="st">&quot;$baseDir/singularity&quot;</span></span></code></pre></div>
<p>Let’s now launch the script test2.nf</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb170-1"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-1"></a>cd test2;</span>
<span id="cb170-2"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-2"></a>nextflow run test2.<span class="fu">nf</span></span>
<span id="cb170-3"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-3"></a></span>
<span id="cb170-4"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-4"></a>N E X T F L O W  ~  version <span class="fl">20.07.</span><span class="dv">1</span></span>
<span id="cb170-5"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-5"></a>Launching `test2.<span class="fu">nf</span>` [distracted_edison] - revision: e3a80b15a2</span>
<span id="cb170-6"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-6"></a>BIOCORE<span class="at">@CRG</span> - N F TESTPIPE  ~  version <span class="fl">1.</span><span class="dv">0</span></span>
<span id="cb170-7"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-7"></a>=============================================</span>
<span id="cb170-8"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-8"></a>reads                           : /home/ec2-user/git/CoursesCRG_Containers_Nextflow_May_<span class="dv">2021</span>/nextflow/nextflow/test2/../testdata<span class="co">/*.fastq.gz</span></span>
<span id="cb170-9"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-9"></a><span class="co">executor &gt;  local (2)</span></span>
<span id="cb170-10"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-10"></a><span class="co">[df/2c45f2] process &gt; fastQC (B7_input_s_chr19.fastq.gz) [  0%] 0 of 2</span></span>
<span id="cb170-11"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-11"></a><span class="co">[-        ] process &gt; multiQC                            -</span></span>
<span id="cb170-12"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-12"></a><span class="co">Error executing process &gt; &#39;fastQC (B7_H3K4me1_s_chr19.fastq.gz)&#39;</span></span>
<span id="cb170-13"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-13"></a></span>
<span id="cb170-14"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-14"></a><span class="co">Caused by:</span></span>
<span id="cb170-15"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-15"></a><span class="co">  Process `fastQC (B7_H3K4me1_s_chr19.fastq.gz)` terminated with an error exit status (127)</span></span>
<span id="cb170-16"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-16"></a></span>
<span id="cb170-17"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-17"></a><span class="co">Command executed:</span></span>
<span id="cb170-18"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-18"></a></span>
<span id="cb170-19"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-19"></a><span class="co">  fastqc B7_H3K4me1_s_chr19.fastq.gz</span></span>
<span id="cb170-20"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-20"></a></span>
<span id="cb170-21"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-21"></a><span class="co">Command exit status:</span></span>
<span id="cb170-22"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-22"></a><span class="co">  127</span></span>
<span id="cb170-23"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-23"></a></span>
<span id="cb170-24"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-24"></a><span class="co">executor &gt;  local (2)</span></span>
<span id="cb170-25"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-25"></a><span class="co">[df/2c45f2] process &gt; fastQC (B7_input_s_chr19.fastq.gz) [100%] 2 of 2, failed: 2 ✘</span></span>
<span id="cb170-26"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-26"></a><span class="co">[-        ] process &gt; multiQC                            -</span></span>
<span id="cb170-27"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-27"></a><span class="co">Error executing process &gt; &#39;fastQC (B7_H3K4me1_s_chr19.fastq.gz)&#39;</span></span>
<span id="cb170-28"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-28"></a></span>
<span id="cb170-29"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-29"></a><span class="co">Caused by:</span></span>
<span id="cb170-30"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-30"></a><span class="co">  Process `fastQC (B7_H3K4me1_s_chr19.fastq.gz)` terminated with an error exit status (127)</span></span>
<span id="cb170-31"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-31"></a></span>
<span id="cb170-32"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-32"></a><span class="co">Command executed:</span></span>
<span id="cb170-33"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-33"></a></span>
<span id="cb170-34"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-34"></a><span class="co">  fastqc B7_H3K4me1_s_chr19.fastq.gz</span></span>
<span id="cb170-35"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-35"></a></span>
<span id="cb170-36"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-36"></a><span class="co">Command exit status:</span></span>
<span id="cb170-37"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-37"></a><span class="co">  127</span></span>
<span id="cb170-38"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-38"></a></span>
<span id="cb170-39"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-39"></a><span class="co">Command output:</span></span>
<span id="cb170-40"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-40"></a><span class="co">  (empty)</span></span>
<span id="cb170-41"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-41"></a></span>
<span id="cb170-42"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-42"></a><span class="co">Command error:</span></span>
<span id="cb170-43"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-43"></a><span class="co">  .command.sh: line 2: fastqc: command not found</span></span>
<span id="cb170-44"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-44"></a></span>
<span id="cb170-45"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-45"></a><span class="co">Work dir:</span></span>
<span id="cb170-46"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-46"></a><span class="co">  /home/ec2-user/git/CoursesCRG_Containers_Nextflow_May_2021/nextflow/nextflow/test2/work/c5/18e76b2e6ffd64aac2b52e69bedef3</span></span>
<span id="cb170-47"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-47"></a></span>
<span id="cb170-48"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb170-48"></a><span class="co">Tip: when you have fixed the problem you can continue the execution adding the option `-resume` to the run command line</span></span></code></pre></div>
<p>We will get a number of errors since no executable is found in our environment / path. This because they are stored in our docker image! So we can launch it this time with the -with-docker parameter.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb171-1"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-1"></a>nextflow run test2.<span class="fu">nf</span> -with-docker</span>
<span id="cb171-2"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-2"></a></span>
<span id="cb171-3"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-3"></a>nextflow run test2.<span class="fu">nf</span> -with-docker</span>
<span id="cb171-4"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-4"></a>N E X T F L O W  ~  version <span class="fl">20.07.</span><span class="dv">1</span></span>
<span id="cb171-5"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-5"></a>Launching `test2.<span class="fu">nf</span>` [boring_hamilton] - revision: e3a80b15a2</span>
<span id="cb171-6"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-6"></a>BIOCORE<span class="at">@CRG</span> - N F TESTPIPE  ~  version <span class="fl">1.</span><span class="dv">0</span></span>
<span id="cb171-7"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-7"></a>=============================================</span>
<span id="cb171-8"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-8"></a>reads                           : /home/ec2-user/git/CoursesCRG_Containers_Nextflow_May_<span class="dv">2021</span>/nextflow/nextflow/test2/../testdata<span class="co">/*.fastq.gz</span></span>
<span id="cb171-9"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-9"></a><span class="co">executor &gt;  local (3)</span></span>
<span id="cb171-10"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-10"></a><span class="co">[22/b437be] process &gt; fastQC (B7_H3K4me1_s_chr19.fastq.gz) [100%] 2 of 2 ✔</span></span>
<span id="cb171-11"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-11"></a><span class="co">[1a/cfe63b] process &gt; multiQC                              [  0%] 0 of 1</span></span>
<span id="cb171-12"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-12"></a><span class="co">executor &gt;  local (3)</span></span>
<span id="cb171-13"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-13"></a><span class="co">[22/b437be] process &gt; fastQC (B7_H3K4me1_s_chr19.fastq.gz) [100%] 2 of 2 ✔</span></span>
<span id="cb171-14"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb171-14"></a><span class="co">[1a/cfe63b] process &gt; multiQC                              [100%] 1 of 1 ✔</span></span></code></pre></div>
<p>This time it worked beautifully since Nextflow used the image indicated within the nextflow.config file that contains our executables.</p>
<p>Now we can have a look at the <strong>params.config</strong> file</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb172-1"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb172-1"></a>params {</span>
<span id="cb172-2"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb172-2"></a>    reads       = <span class="st">&quot;$baseDir/../testdata/*.fastq.gz&quot;</span></span>
<span id="cb172-3"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb172-3"></a>    email       = <span class="st">&quot;myemail@google.com&quot;</span></span>
<span id="cb172-4"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb172-4"></a>}</span></code></pre></div>
<p>As you can see we indicates the pipeline parameters that can be overridden by using <strong>–reads</strong> and <strong>–email</strong>. This is not mandatory but I found quite useful to modify this file instead of using very long command lines with tons of <strong>–something</strong>.</p>
<p>Now, let’s have a look at the folders generated by the pipeline.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb173-1"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb173-1"></a><span class="fu">ls</span>  work/2a/22e3df887b1b5ac8af4f9cd0d88ac5/</span>
<span id="cb173-2"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb173-2"></a></span>
<span id="cb173-3"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb173-3"></a><span class="ex">total</span> 0</span>
<span id="cb173-4"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb173-4"></a><span class="ex">drwxrwxr-x</span> 3 ec2-user ec2-user  26 Apr 23 13:52 .</span>
<span id="cb173-5"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb173-5"></a><span class="ex">drwxr-xr-x</span> 2 root     root     136 Apr 23 13:51 multiqc_data</span>
<span id="cb173-6"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb173-6"></a><span class="ex">drwxrwxr-x</span> 3 ec2-user ec2-user  44 Apr 23 13:51 ..</span></code></pre></div>
<p>We observe that Docker runs as “root”. This can be problematic and generates security issues. To avoid this we can add this line of code within the process section of the config file:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb174-1"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb174-1"></a>  <span class="ex">containerOptions</span> = { workflow.containerEngine == <span class="st">&quot;docker&quot;</span> ? <span class="st">&#39;-u $(id -u):$(id -g)&#39;</span>: null}</span></code></pre></div>
<p>This will tell to Nextflow that if is running with docker, this has to produce files that belong to your user and not to root.</p>
<div id="publishing-final-results" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Publishing final results</h3>
<p>After running the script you see two new folders named <strong>ouptut_fastqc</strong> and <strong>ouptut_fastqc</strong> that contain the result of the pipeline.
We can indicate which process and which output can be considered the final output of the pipeline by using the <strong>publishDir</strong> directive that has to be specified at the beginning of a process.</p>
<p>In our pipeline we define these folders here:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb175-1"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-1"></a><span class="co">/*</span></span>
<span id="cb175-2"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-2"></a><span class="co"> * Defining the output folders.</span></span>
<span id="cb175-3"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-3"></a><span class="co"> */</span></span>
<span id="cb175-4"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-4"></a>fastqcOutputFolder    = <span class="st">&quot;ouptut_fastqc&quot;</span></span>
<span id="cb175-5"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-5"></a>multiqcOutputFolder   = <span class="st">&quot;ouptut_multiQC&quot;</span></span>
<span id="cb175-6"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-6"></a></span>
<span id="cb175-7"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-7"></a></span>
<span id="cb175-8"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-8"></a>[...]</span>
<span id="cb175-9"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-9"></a></span>
<span id="cb175-10"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-10"></a><span class="co">/*</span></span>
<span id="cb175-11"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-11"></a><span class="co"> * Process 1. Run FastQC on raw data. A process is the element for executing scripts / programs etc.</span></span>
<span id="cb175-12"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-12"></a><span class="co"> */</span></span>
<span id="cb175-13"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-13"></a>process fastQC {</span>
<span id="cb175-14"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-14"></a>    publishDir fastqcOutputFolder           <span class="co">// where (and whether) to publish the results</span></span>
<span id="cb175-15"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-15"></a></span>
<span id="cb175-16"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-16"></a>[...]</span>
<span id="cb175-17"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-17"></a></span>
<span id="cb175-18"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-18"></a><span class="co">/*</span></span>
<span id="cb175-19"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-19"></a><span class="co"> * Process 2. Run multiQC on fastQC results</span></span>
<span id="cb175-20"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-20"></a><span class="co"> */</span></span>
<span id="cb175-21"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-21"></a>process multiQC {</span>
<span id="cb175-22"><a href="decoupling-resources-parameters-and-nextflow-script.html#cb175-22"></a>    publishDir multiqcOutputFolder, mode: &#39;copy&#39;    <span class="co">// this time do not link but copy the output file</span></span></code></pre></div>
<p>You can see that the default mode to publish the results in Nextflow is soft linking. You can change this behaviour by specifying the mode as indicated in the <strong>multiQC</strong> process.</p>
<p><strong>IMPORTANT: You can also “move” the results but this is not suggested for files that will be needed for other processes. This will likely disrupt your pipeline.</strong></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="nextflow-day-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="adding-a-help-section-for-the-whole-pipeline.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["courses_at_crg_2021.pdf", "courses_at_crg_2021.epub"],
"toc": {
"collapse": "section"
},
"search": true
});
});
</script>

</body>

</html>
